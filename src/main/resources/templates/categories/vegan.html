<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:include="partials/head.html :: head">
    <meta charset="UTF-8">
    <title>Vegan</title>
</head>
<body>
    <div th:include="partials/navbar.html :: navbar"></div>
        <form th:action="@{/vegan}" method="post">
            <h4>The True Veggie Lovers</h4>
            <form action="">
                <button id="vegan">Vegan Variety</button><br>
            </form>
        </form>
    <div id="recipe-cards" class="d-flex flex-wrap">

    </div>

    <script th:inline="javascript">
        const spoonkey = /*[[${spoonkey}]]*/ 'default';
        console.log(spoonkey);
        const url = "https://api.spoonacular.com/recipes/random?number=100&apiKey=" + spoonkey;
        const options = {
            method: "GET"
        };
        const spoon = function(e) {
            e.preventDefault();
            fetch(url, options).then(response => response.json())
                .then(response =>{
                    var veganArr = [];
                    var iterator = 0;
                    do{
                        // console.log(response.recipes[0].glutenFree);
                        if(response.recipes[iterator].vegan === true){
                            if (veganArr.includes(response.recipes[iterator]) === false) veganArr.push(response.recipes[iterator]);
                        }
                        iterator++;
                    }while(veganArr.length < 20)
                    console.log(veganArr);
                    var emptyString="";
                    for(var k=0; k <veganArr.length; k++){

                        emptyString+="<div class='card col-4'>"
                        emptyString+="<div class='card-title'><h3>" + veganArr[k].title + "</h3></div><br>"
                        emptyString+="<div><img style='width: 325px' alt='recipeImg' src="+ veganArr[k].image +"></div>"
                        emptyString+="<div class='card-body'><p>" + veganArr[k].instructions + "</p></div>"
                        emptyString+="</div>"

                    }
                    $("#recipe-cards").html(emptyString);
                })
                .then(response => console.log(response))
        }
        document.getElementById("vegan").addEventListener('click', spoon);
        /*]]>*/
    </script>

</body>
</html>